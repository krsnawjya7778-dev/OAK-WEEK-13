"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5581],{4178:(e,t,i)=>{i.d(t,{A:()=>g});var s=i(37876),l=i(18847),n=i.n(l),a=i(14232),r=i(43449),o=i(95932),d=i.n(o),c=i(62426),p=i.n(c),h=i(20128);let u=n()(()=>i.e(5830).then(i.bind(i,75830)),{loadableGenerated:{webpack:()=>[75830]},ssr:!1}),g=e=>{let t=(0,h.M)(),[i,l]=(0,a.useState)(null),[n,o]=(0,a.useState)(null);return(0,a.useEffect)(()=>{l({code:t=>{let i=Array.isArray(t.children)?t.children[0]:t.children;return t.inline?(0,s.jsx)("code",{children:i}):(0,s.jsx)(u,{language:t.language||t.className,value:i,disableCopyPaste:e.disableCopyPaste})},a:e=>(0,s.jsx)("a",{href:e.href,target:"_blank",rel:"noopener noreferrer nofollow",children:e.children})}),o((null==t?void 0:t.theme)==="dark"?"dark":"light")},[null==t?void 0:t.theme]),(0,s.jsx)(r.$,{className:"md-view oc-theme-".concat(n," ").concat(e.disableCopyPaste?"unselectable":""),remarkPlugins:[p(),d()],components:i||{},children:e.markdown||""})}},36804:(e,t,i)=>{i.d(t,{A:()=>r});var s=i(37876),l=i(18952),n=i(20243),a=i(52782);let r=e=>{let t="Public (Everyone)",i="Private (Only You)",r="Unlisted (People with the Link)";return e.channelType&&"org"===e.channelType&&(t="Public (Visible outside of org)",i="Private (Visible only for org members)",r="Unlisted (People outside org with the link)"),e.channelType&&"team"===e.channelType&&(t="Public (Visible outside of team)",i="Private (Visible only for team members)",r="Unlisted (People outside team with the link)"),(0,s.jsxs)(l.A,{variant:e.variant||"outlined",style:{minWidth:e.minWidth||"200"},children:[(0,s.jsx)(n.A,{htmlFor:"visibility-selector",children:"Visibility"}),(0,s.jsxs)(a.A,{native:!0,value:e.value,onChange:t=>{e.onChange(t.target.value)},label:"Visibility",inputProps:{name:"visibility",id:"visibility-selector"},children:[(0,s.jsx)("option",{value:"public",children:t}),(0,s.jsx)("option",{value:"private",children:i}),!e.channelType&&(0,s.jsx)("option",{value:"unlisted",children:r})]})]})}},85581:(e,t,i)=>{i.r(t),i.d(t,{default:()=>e4});var s=i(37876),l=i(14924),n=i(19055),a=i(41316),r=i(14232),o=i(48011),d=i(9397),c=i(9447),p=i(54343),h=i(75039),u=i(79270),g=i(92003),x=i(7579),m=i(1912),j=i(71918),b=i(86198),y=i(25128);let v=r.forwardRef(function(e,t){return(0,s.jsx)(h.A,{direction:"down",ref:t,...e})}),A=e=>{let t=(0,o.wA)(),i=(0,o.d4)(e=>e.user.editorFontSize)||14,l=(0,o.d4)(e=>e.user.editorDisableAutoComplete)||!1;return(0,s.jsxs)(u.A,{fullWidth:!0,maxWidth:"sm",onClose:()=>{e.onClose()},TransitionComponent:v,open:e.open,children:[(0,s.jsxs)(a.Ay,{container:!0,style:{paddingLeft:20,paddingRight:20,marginTop:20},children:[(0,s.jsxs)(g.A,{variant:"h6",component:"h1",gutterBottom:!0,color:"secondary",children:[" ","Editor Settings"," "]}),(0,s.jsx)("br",{}),(0,s.jsx)(x.A,{}),(0,s.jsx)("br",{}),(0,s.jsx)(m.A,{id:"outlined-multiline-flexible",style:{padding:10},required:!0,size:"small",type:"number",margin:"normal",variant:"outlined",label:"Font Size (8-32)",fullWidth:!0,value:i,onChange:e=>t((0,y.HM)(e.target.value)),slotProps:{htmlInput:{min:"8",max:"32"}}}),(0,s.jsx)(j.A,{labelPlacement:"start",control:(0,s.jsx)(b.A,{checked:l,onChange:e=>t((0,y.h$)(e.target.checked)),name:"autoCompleteToggle",color:"primary"}),label:"Disable Code Autocomplete/ Suggestions"})]}),(0,s.jsx)("br",{}),(0,s.jsx)("br",{})]})};var f=i(44810),C=i(71733),w=i(62034),k=i(63356),O=i(44725),S=i(58830),I=i(88787),T=i(95062),R=i.n(T),F=i(63589);let z=r.forwardRef(function(e,t){return(0,s.jsx)(h.A,{direction:"down",ref:t,...e})});class M extends r.Component{render(){let{classes:e}=this.props,{onClose:t,selectedValue:i,...n}=this.props,{value:r}=this.state,o=[];return this.props.availableLanguages?this.props.availableLanguages.length:Object.values(d).filter(e=>e.active).length,["Programming","Web","Database","Tool"].map(e=>{o.push({languageType:e,languageTitle:"Tool"===e?"Tools":"".concat(e," languages"),languagesAvailable:this.languageOptionsByType(e.toLowerCase(),this.props.availableLanguages)})}),(0,s.jsx)(u.A,{fullWidth:!0,maxWidth:"md",onClose:this.handleClose,TransitionComponent:z,open:this.props.open,children:0===r&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(a.Ay,{container:!0,direction:"row",justifyContent:"flex-end",alignItems:"flex-start",children:(0,s.jsx)(a.Ay,{item:!0,xs:12,md:4,children:(0,s.jsxs)(l.A,{className:"oc-card",sx:e=>({marginRight:e.spacing(4),display:"flex",alignItems:"center",marginTop:e.spacing(2),marginBottom:0}),elevation:0,children:[(0,s.jsx)(f.Ay,{size:"small",onChange:e=>this.setState({searchString:e.target.value}),value:this.state.searchString,sx:e=>({marginLeft:e.spacing(3),flex:1}),placeholder:"Search languages...",inputProps:{"aria-label":"Search languages"},autoFocus:!0}),this.state.searchString?(0,s.jsx)(C.A,{sx:{padding:"10px"},"aria-label":"search",onClick:e=>this.setState({searchString:""}),size:"large",children:(0,s.jsx)(O.A,{})}):(0,s.jsx)(C.A,{sx:{padding:"10px"},"aria-label":"search",size:"large",children:(0,s.jsx)(I.A,{})})]})})}),(0,s.jsxs)(a.Ay,{container:!0,style:{paddingLeft:20,paddingRight:20},children:[o.map(e=>(0,s.jsx)(a.Ay,{item:!0,container:!0,direction:"row",children:0!=e.languagesAvailable.length&&(0,s.jsxs)("div",{style:{width:"100%"},children:[(0,s.jsxs)(g.A,{variant:"h6",component:"h1",gutterBottom:!0,color:"secondary",children:[" ",e.languageTitle," "]}),(0,s.jsx)(x.A,{}),(0,s.jsx)(a.Ay,{container:!0,children:e.languagesAvailable.map(e=>{let t=d[e];return"home"!==this.props.source&&t.beta?null:t.properties&&t.properties.url?(0,s.jsx)(a.Ay,{item:!0,sm:6,md:3,lg:3,sx:{cursor:"pointer",padding:"5px",borderRadius:"5px","&:hover":{backgroundColor:e=>"dark"===e.palette.mode?e.palette.grey[800]:e.palette.grey[300]}},children:(0,s.jsx)("a",{href:t.properties.url,target:"_blank",children:(0,s.jsx)(g.A,{variant:"subtitle1",component:"h2",children:(0,s.jsxs)(w.A,{sx:{display:"flex",alignItems:"center"},children:[t.name,(0,s.jsx)(S.A,{})]})})})},e):(0,s.jsx)(a.Ay,{item:!0,sm:6,md:3,lg:3,sx:{cursor:"pointer",padding:"5px",borderRadius:"5px","&:hover":{backgroundColor:e=>"dark"===e.palette.mode?e.palette.grey[800]:e.palette.grey[300]}},onClick:t=>this.props.handleListItemClick(e),children:(0,s.jsx)("a",{children:(0,s.jsxs)(w.A,{sx:{display:"flex",alignItems:"center"},children:[(0,s.jsx)(g.A,{variant:"subtitle1",component:"h2",color:"primary",children:t.name}),t.beta&&(0,s.jsx)(S.A,{fontSize:"small",className:"ml5",color:"primary"})]})})},e)})}),(0,s.jsx)("br",{})]})},e.languageType)),"home"===this.props.source&&"IN"!==this.props.countryCode&&(0,s.jsx)(a.Ay,{item:!0,container:!0,direction:"row",style:{marginBottom:10},children:(0,s.jsxs)("div",{style:{width:"100%"},children:[(0,s.jsxs)(g.A,{variant:"h6",component:"h1",gutterBottom:!0,color:"secondary",children:[" ","Studio"," "]}),(0,s.jsx)(x.A,{}),(0,s.jsx)(a.Ay,{container:!0,children:(this.state.searchString?Object.values(F).filter(e=>e.title.toLowerCase().includes(this.state.searchString.toLowerCase())):Object.values(F)).map(e=>(0,s.jsx)(a.Ay,{item:!0,sm:6,md:3,lg:3,sx:{cursor:"pointer",padding:"5px",borderRadius:"5px","&:hover":{backgroundColor:e=>"dark"===e.palette.mode?e.palette.grey[800]:e.palette.grey[300]}},children:(0,s.jsx)("a",{href:"/studio/".concat(e._id),target:"_blank",children:(0,s.jsxs)(w.A,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,s.jsx)(g.A,{variant:"subtitle1",component:"h2",color:"primary",children:e.title}),e.freeTier&&(0,s.jsx)(k.A,{label:"Free Tier",size:"small",sx:{height:{xs:16,sm:18},fontSize:{xs:"0.563rem",sm:"0.625rem"},fontWeight:600,backgroundColor:e=>"dark"===e.palette.mode?"#065f46":"#d1fae5",color:e=>"dark"===e.palette.mode?"#6ee7b7":"#065f46","& .MuiChip-label":{padding:{xs:"0 4px",sm:"0 6px"}}}})]})})},e._id))})]})},"studio"),"home"===this.props.source&&!1]})]})})}constructor(...e){super(...e),this.state={value:0,searchString:""},this.handleChange=(e,t)=>{this.setState({value:t})},this.handleClose=()=>{this.props.onClose()},this.languageOptionsByType=(e,t)=>{let i="";return this.state.searchString&&(i=Object.keys(d).filter(e=>e.toLowerCase().includes(this.state.searchString.toLowerCase())||d[e].name.toLowerCase().includes(this.state.searchString.toLowerCase()))),(i||Object.keys(d)).filter(e=>d[e].active).filter(t=>d[t].languageType===e).filter(e=>!t||!!t.includes(e))}}}M.propTypes={onClose:R().func,selectedValue:R().string};var P=i(58213),U=i(80429);let _=e=>{let{codeObj:t}=e;return(0,s.jsx)("div",{style:{paddingTop:2,paddingRight:2,float:"right"},children:(0,s.jsxs)(g.A,{variant:"caption",gutterBottom:!0,children:[(0,s.jsxs)("span",{itemProp:"datePublished",dateTime:"".concat(new Date(t.updated).toISOString().split("T")[0]),children:["created ".concat((0,P.A)(new Date(t.created),{max:1,suffix:!0}))," "]}),t.user&&t.user.name&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{children:" by "}),(0,s.jsx)(U.Link,{route:"/users/".concat(t.user._id),children:(0,s.jsx)("span",{children:(0,s.jsx)("span",{itemProp:"author",itemScope:!0,itemType:"http://schema.org/Person",children:(0,s.jsx)("span",{itemProp:"name",children:"".concat(t.user.name)})})})})]})]})})};var L=i(80553),W=i(67906),E=i(84812),D=i(36804);let N=r.forwardRef(function(e,t){return(0,s.jsx)(h.A,{direction:"down",ref:t,...e})}),V=e=>{let{open:t,handleClose:i,codeObj:l,handleUpdate:n,visibility:a,token:r,handleSave:o}=e;return(0,s.jsxs)(u.A,{open:t,TransitionComponent:N,fullWidth:!0,maxWidth:"md",onClose:i,children:[(0,s.jsx)(L.A,{children:(0,s.jsxs)("div",{children:[(0,s.jsx)(m.A,{id:"outlined-name",label:"Name",style:{width:"100%"},margin:"normal",variant:"outlined",value:l.title,onChange:e=>n("title",e.target.value)}),(0,s.jsx)("br",{}),(0,s.jsx)(m.A,{id:"outlined-multiline-flexible",fullWidth:!0,label:"Description",multiline:!0,rows:"4",maxRows:"20",margin:"normal",variant:"outlined",value:l.description||"",onChange:e=>n("description",e.target.value)}),(0,s.jsx)("br",{}),(0,s.jsx)(m.A,{id:"outlined-tags",label:"Tags",margin:"normal",variant:"outlined",style:{width:"100%"},value:l.tags?l.tags.join(", "):"",onChange:e=>{let t=e.target.value;t?n("tags",t.split(",").map(e=>e.trim().toLowerCase())):n("tags",[])}}),!a&&r&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("br",{}),(0,s.jsx)("br",{}),(0,s.jsx)(D.A,{value:l.visibility||"public",onChange:e=>n("visibility",e)})]})]})}),(0,s.jsxs)(W.A,{children:[(0,s.jsx)(E.A,{variant:"outlined",size:"small",color:"secondary",onClick:i,children:"Close"}),"\xa0\xa0",(0,s.jsx)(E.A,{variant:"outlined",size:"small",color:"primary",onClick:e=>{o()},children:"Save"})]})]})},B=e=>{var t,i,n,r,o;let{codeObj:d}=e;return(0,s.jsx)(a.Ay,{container:!0,children:(0,s.jsx)(a.Ay,{item:!0,xs:12,children:(0,s.jsx)(l.A,{variant:"outlined",style:{padding:"8px",overflow:"auto",maxHeight:"calc(100vh - 110px)"},children:(0,s.jsxs)("pre",{children:[" ",(null==d||null==(i=d.properties)||null==(t=i.files)?void 0:t.length)>0?null==d||null==(o=d.properties)||null==(r=o.files)||null==(n=r[0])?void 0:n.content:""," "]})})})})};var H=i(61994),G=i(98330),Y=i(39943),Z=i(53701),J=i(15852),q=i(87080),K=i(60230),$=i(66703),Q=i(59055),X=i(59893),ee=i(43486),et=i(94683),ei=i(37387),es=i(32701),el=i(62681),en=i(840),ea=i(90487),er=i(52894),eo=i(65422),ed=i(4178);function ec(e){let t=e.embedMode||!1,[i,n]=(0,r.useState)(""),a=(0,r.useRef)(null),o=async()=>{i&&""!==i.trim()&&(e.sendMessage(i),n(""),a.current&&(a.current.style.height="auto"))};return(0,s.jsxs)(s.Fragment,{children:[!e.userToken&&!t&&(0,s.jsx)(er.A,{action:(0,s.jsx)(E.A,{color:"inherit",size:"small",onClick:()=>{window.open("/login","_blank")},children:"Login"}),severity:"warning",children:"Please login to interact with the AI"}),(0,s.jsxs)(w.A,{sx:{backgroundColor:e=>e.palette.background.default,display:"flex",alignItems:"center",padding:e=>e.spacing(1,2)},children:[(0,s.jsx)(l.A,{variant:"outlined",component:w.A,flexGrow:1,ml:2,p:1,sx:{display:"flex",alignItems:"center"},children:(0,s.jsx)("textarea",{ref:a,disabled:!e.userToken&&!t,value:i,onChange:e=>{n(e.target.value),a.current&&(a.current.style.height="auto",a.current.style.height=a.current.scrollHeight+"px")},onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),o())},placeholder:"Leave a message (Shift+Enter for new line)",style:{width:"100%",border:"none",outline:"none",resize:"none",fontFamily:"inherit",fontSize:"inherit",backgroundColor:"transparent",color:"inherit",minHeight:"24px",maxHeight:"120px",overflow:"auto",lineHeight:"1.5",padding:"0",margin:"0",verticalAlign:"middle"},rows:"1"})}),(0,s.jsx)(J.A,{title:"Send",children:(0,s.jsx)("span",{children:(0,s.jsx)(C.A,{color:"primary",disabled:!i||""===i.trim()||!e.userToken&&!t,onClick:o,size:"large",children:(0,s.jsx)(ei.A,{fontSize:"small",children:(0,s.jsx)(el.A,{})})})})})]})]})}let ep=e=>{let t=(0,o.wA)(),[i,l]=r.useState([]),[a,d]=(0,r.useState)(!1),[c,p]=(0,r.useState)(!1),{token:h,plan:u}=(0,o.d4)(e=>e.user),m=(0,r.useRef)(null),j=e.embedMode||!1,[b]=(0,r.useState)(()=>Math.floor(10*Math.random()));async function v(t){if((null==t?void 0:t.length)>2e3)return alert("Message is too long. Please keep it under 2000 characters.");l(e=>[...e,{content:t,role:"user"}]),p(!0);let s={content:"",role:"assistant"};l(e=>[...e,s]);let n="";try{var a,r,o,d,c,u,g,x;let p=await fetch("/api/ai/stream",{method:"POST",headers:{"Content-Type":"application/json",...h&&{Authorization:"Bearer ".concat(h)}},body:JSON.stringify({module:"editor",usecase:j?"codeHelpEmbedded":"codeHelp",currentMessage:t,conversation:i,modelPreference:b,metadata:{language:null==(r=e.codeObj)||null==(a=r.properties)?void 0:a.language,files:null==(d=e.codeObj)||null==(o=d.properties)?void 0:o.files,stdin:null==(u=e.codeObj)||null==(c=u.properties)?void 0:c.stdin,stdout:null==(x=e.codeObj)||null==(g=x.properties)?void 0:g.stdout}})});if(!p.ok)throw Error("HTTP error! status: ".concat(p.status));let m=p.body.getReader(),y=new TextDecoder,v=!1;for(;!v;){let{value:e,done:t}=await m.read();if(v=t,e){let t=y.decode(e);n+=t,l(e=>{let t=[...e];return t[t.length-1]={...s,content:n},t})}}}catch(e){console.error("Streaming error: ".concat(null==e?void 0:e.message)),l(e=>{let t=[...e];return t[t.length-1]={...s,content:"Sorry, I couldn't get a response. Please try again."},t})}p(!1)}(0,r.useEffect)(()=>{m.current&&m.current.scrollIntoView({behavior:"smooth"})},[i]);let A=()=>{d(!1)},f=()=>{window.open("/pricing","_blank")};return(0,s.jsxs)(n.A,{children:[(0,s.jsx)(J.A,{title:"AI Help",children:(0,s.jsx)("button",{onClick:()=>{d(!0),!h||u||j||t((0,y.D)(h))},style:{background:"#2ecc71",color:"white",border:"none",borderRadius:5,padding:4,marginRight:4,marginTop:3,cursor:"pointer"},children:(0,s.jsxs)("span",{style:{marginLeft:1,marginRight:4},children:[(0,s.jsx)("img",{src:"/static/images/work/ai4.png",alt:"AI",style:{width:12,height:12}})," "," AI "]})})}),(0,s.jsxs)(et.Ay,{anchor:"right",sx:{"& .MuiDrawer-paper":{width:500,maxWidth:"100%"}},ModalProps:{BackdropProps:{invisible:!0}},onClose:A,open:a,variant:"temporary",children:[(0,s.jsx)(w.A,{p:1,children:(0,s.jsxs)(w.A,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[(0,s.jsx)(g.A,{variant:"h6",color:"textPrimary",children:"Editor AI"}),(0,s.jsxs)("div",{children:[!u&&!j&&(0,s.jsx)(E.A,{variant:"outlined",endIcon:(0,s.jsx)(en.A,{}),size:"small",color:"primary",onClick:f,disabled:!h,sx:{mr:2},children:"Upgrade"}),(0,s.jsx)(J.A,{title:"Close AI Chat",children:(0,s.jsx)(C.A,{onClick:A,size:"large",children:(0,s.jsx)(es.A,{})})})]})]})}),(0,s.jsx)(x.A,{}),(0,s.jsx)("div",{id:"scrollableDiv",style:{height:"calc(100vh - 40px)",overflow:"auto",display:"flex",flexDirection:"column-reverse"},children:(0,s.jsx)(w.A,{flexGrow:1,p:1,children:(0,s.jsxs)(eo.A,{dataLength:i.length,inverse:!1,style:{display:"flex",flexDirection:"column"},hasMore:!1,scrollableTarget:"scrollableDiv",children:[0===i.length&&(0,s.jsxs)(w.A,{sx:{textAlign:"center",py:4,color:"text.secondary"},children:[(0,s.jsx)(ea.A,{sx:{fontSize:48,mb:2,opacity:.7}}),(0,s.jsxs)(g.A,{variant:"body2",children:["Ask me anything about your code! ",(0,s.jsx)("br",{})," I have the latest version of your code and the output of your code."]})]}),i.length>0&&i.map((e,t)=>{var i;return(0,s.jsx)(w.A,{sx:{mb:2},children:"user"===e.role?(0,s.jsxs)(w.A,{sx:{display:"flex",alignItems:"flex-start"},children:[(0,s.jsx)(g.A,{sx:{color:"text.secondary",fontFamily:"monospace",fontSize:"0.9rem",mr:1},children:">"}),(0,s.jsx)(w.A,{sx:{flex:1},children:(0,s.jsx)(g.A,{variant:"body2",sx:{fontFamily:"monospace",fontSize:"0.9rem",color:"text.primary",whiteSpace:"pre-wrap"},children:e.content})})]}):(0,s.jsxs)(w.A,{children:[""===e.content&&c&&(0,s.jsxs)(w.A,{sx:{display:"flex",alignItems:"center",gap:1,color:"text.secondary"},children:[(0,s.jsx)(g.A,{variant:"body2",sx:{fontStyle:"italic"},children:"Thinking..."}),(0,s.jsxs)(w.A,{sx:{display:"flex",gap:.3},children:[(0,s.jsx)(w.A,{sx:{width:4,height:4,borderRadius:"50%",backgroundColor:"currentColor",opacity:.3,"@keyframes pulse":{"0%, 80%, 100%":{opacity:.3},"40%":{opacity:1}},animation:"pulse 1.4s infinite",animationDelay:"0s"}}),(0,s.jsx)(w.A,{sx:{width:4,height:4,borderRadius:"50%",backgroundColor:"currentColor",animation:"pulse 1.4s infinite",animationDelay:"0.2s"}}),(0,s.jsx)(w.A,{sx:{width:4,height:4,borderRadius:"50%",backgroundColor:"currentColor",animation:"pulse 1.4s infinite",animationDelay:"0.4s"}})]})]}),e.content&&(0,s.jsx)(ed.A,{markdown:null==e?void 0:e.content}),(null==e||null==(i=e.content)?void 0:i.startsWith("You have reached the daily limit"))&&!j&&(0,s.jsx)("div",{style:{display:"flex",justifyContent:"center",marginTop:"1rem"},children:(0,s.jsx)(E.A,{size:"small",color:"primary",onClick:f,style:{paddingRight:"25px"},children:"Upgrade"})})]})},t)}),(0,s.jsx)("div",{ref:m})]})})}),(0,s.jsx)(x.A,{}),(0,s.jsx)(ec,{sendMessage:v,userToken:h,embedMode:j})]})]})};var eh=i(10482),eu=i(44395),eg=i(72147),ex=i(18952),em=i(20243),ej=i(52782),eb=i(96605);let ey=/^[a-z0-9_-]+$/,ev=e=>{let{codeObj:t}=e,[i,l]=(0,r.useState)(!1),[n,a]=(0,r.useState)(!1),[d,c]=(0,r.useState)(!1),[h,g]=(0,r.useState)(""),[x,j]=(0,r.useState)({slug:"",title:"",description:"",visibility:"public"}),[b,y]=(0,r.useState)({}),[v,A]=(0,r.useState)(null),[f,k]=(0,r.useState)(""),O=(0,o.d4)(e=>e.user.token),I=(0,o.d4)(e=>e.user.plan);(0,r.useEffect)(()=>{T()},[i,t]);let T=async()=>{if(i&&t&&t._id){c(!0),g("");try{let{statusCode:e,json:i,error:s}=await (0,p.ZM)("/api/deployments/getDeploymentBySourceId/".concat(t._id),O);200===e&&i&&i.slug?(j({slug:i.slug||"",title:i.title||"",description:i.description||"",visibility:i.visibility||"public"}),A(i._id)):(j({slug:"",title:"",description:"",visibility:"public"}),A(null))}catch(e){g("Failed to fetch deployment info.")}finally{c(!1)}}else i&&(j({slug:"",title:"",description:"",visibility:"public"}),A(null));g(""),k(""),y({})},R=e=>{let{name:t,value:i}=e.target;"slug"===t&&(i=i.replace(/[^a-z0-9_-]/g,"")),j({...x,[t]:i}),y({...b,[t]:void 0})},F=async()=>{let e=(()=>{let e={};return x.slug?x.slug.length<4?e.slug="App Id must be at least ".concat(4," characters"):x.slug.length>63?e.slug="App Id must be at most ".concat(63," characters"):ey.test(x.slug)||(e.slug="Only lowercase letters, numbers, _ and - allowed"):e.slug="App Id is required",x.title?x.title.length>50&&(e.title="App Title must be at most ".concat(50," characters")):e.title="App Title is required",x.description&&x.description.length>1e3&&(e.description="App Description must be at most ".concat(1e3," characters")),e})();if(Object.keys(e).length)return void y(e);a(!0),g(""),k("");try{var i,s;let{statusCode:e,json:l}=await (0,p.ZM)("/api/deployments/isSlugAvailable/".concat(x.slug),O);if(200!==e||l&&!1===l.available){y(e=>({...e,slug:"Slug is not available. Please choose another."})),a(!1);return}let{statusCode:n,json:r,error:o}=await (0,p.RA)("/api/deployments",O,{...x,sourceId:t._id,_id:v,files:null==t||null==(i=t.properties)?void 0:i.files,source:"editor"});200===n&&"success"===r.status?(k("Deployment saved successfully!"),A(null==r||null==(s=r.doc)?void 0:s._id)):g(r&&r.message||o||"Failed to save deployment")}catch(e){g("Failed to save deployment")}finally{a(!1)}},z=!t||!t._id;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(J.A,{title:"Deploy this program",children:(0,s.jsx)(C.A,{size:"large",sx:{mr:1},onClick:()=>l(!0),children:(0,s.jsx)(eb.A,{color:"textSecondary"})})}),(0,s.jsxs)(u.A,{open:i,onClose:()=>l(!1),maxWidth:"sm",fullWidth:!0,children:[(0,s.jsx)(eu.A,{children:"Deploy Program"}),(0,s.jsx)(L.A,{dividers:!0,children:z?(0,s.jsx)(er.A,{severity:"warning",children:"Please change & run the code before deploy."}):d?(0,s.jsx)(w.A,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:100,children:(0,s.jsx)(eg.A,{})}):(0,s.jsxs)(w.A,{component:"form",noValidate:!0,autoComplete:"off",sx:{display:"flex",flexDirection:"column",gap:2},children:[(0,s.jsx)(m.A,{label:"App Title",name:"title",value:x.title,onChange:R,error:!!b.title,helperText:b.title||"".concat(x.title.length,"/").concat(50," characters"),inputProps:{maxLength:50},required:!0,disabled:n}),(0,s.jsx)(m.A,{label:"App Description",name:"description",value:x.description,onChange:R,error:!!b.description,helperText:b.description||"".concat(x.description.length,"/").concat(1e3," characters"),inputProps:{maxLength:1e3},multiline:!0,minRows:2,maxRows:4,disabled:n}),(0,s.jsx)(m.A,{label:"App Id",name:"slug",value:x.slug,onChange:R,error:!!b.slug,helperText:b.slug||"App Id must be at least ".concat(4," characters. Only lowercase letters, numbers, _ and - allowed"),inputProps:{pattern:"[a-z0-9_-]+",maxLength:63},required:!0,disabled:n}),(0,s.jsx)(w.A,{sx:{minWidth:200},children:(0,s.jsxs)(ex.A,{variant:"outlined",style:{minWidth:200},children:[(0,s.jsx)(em.A,{htmlFor:"visibility-selector",children:"Visibility"}),(0,s.jsxs)(ej.A,{native:!0,value:x.visibility,onChange:e=>{var t;return t=e.target.value,void(j({...x,visibility:t}),y({...b,visibility:void 0}))},label:"Visibility",inputProps:{name:"visibility",id:"visibility-selector"},children:[(0,s.jsx)("option",{value:"public",children:"Public (Everyone)"}),(0,s.jsx)("option",{value:"unlisted",children:"Unlisted (People with the Link)"})]})]})}),"unlisted"===x.visibility&&!I&&(0,s.jsx)(er.A,{severity:"warning",action:(0,s.jsx)(E.A,{color:"inherit",size:"small",onClick:()=>window.open("/pricing","_blank"),children:"Upgrade"}),children:"Please upgrade your plan to use unlisted."}),h&&(0,s.jsx)(er.A,{severity:"error",children:h.split("\n").map((e,t)=>(0,s.jsxs)("span",{children:[e,t<h.split("\n").length-1&&(0,s.jsx)("br",{})]},t))}),f&&(0,s.jsx)(er.A,{severity:"success",children:f})]})}),(0,s.jsxs)(W.A,{children:[v&&x.slug&&(0,s.jsx)(w.A,{flexGrow:1,display:"flex",justifyContent:"flex-start",children:(0,s.jsx)(E.A,{variant:"outlined",color:"primary",href:"https://".concat(x.slug,".oneapp.dev"),target:"_blank",rel:"noopener noreferrer",endIcon:(0,s.jsx)(S.A,{}),children:"View Your App"})}),(0,s.jsxs)(w.A,{display:"flex",gap:1,children:[(0,s.jsx)(E.A,{onClick:()=>l(!1),color:"primary",variant:"outlined",disabled:n,children:"Close"}),(0,s.jsx)(E.A,{onClick:F,color:"primary",variant:"contained",disabled:z||n||d||"unlisted"===x.visibility&&!I,children:n?(0,s.jsx)(eg.A,{size:24}):"Deploy"})]})]})]})]})},eA=e=>{var t,i,l,a;let{codeObj:o,embed:p,running:h,showAi:u,source:g,hideNew:x,handleNewClick:m,hideLanguageSelection:j,handleLanguageModelOpen:b,codeVsConsoleSwitchValue:y,hideRun:v,handleRunClick:A,hideEditorOptions:f,handleEditorSettingsOpen:k,handleClearOutput:O,handleCodeMetaEdit:S,fullscreen:I,switchFullscreen:T,handleCodeVsConsoleSwitch:R}=e,F=(0,$.A)(),z=(0,Q.A)(F.breakpoints.up("sm")),M=(0,Q.A)(F.breakpoints.down("sm"));return(0,s.jsxs)(n.A,{children:["home"===g&&(null==(i=d[o.properties.language])||null==(t=i.properties)?void 0:t.enableDeployments)&&(0,s.jsx)(ev,{codeObj:o}),u&&(0,s.jsx)(ep,{codeObj:o,embedMode:!0}),"home"===g&&(0,s.jsx)(ep,{codeObj:o,embedMode:!1}),!0!==x&&z&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(J.A,{title:"Create a new ".concat(null==o||null==(a=o.properties)||null==(l=a.language)?void 0:l.toUpperCase()," program"),children:(0,s.jsx)(E.A,{color:"primary",size:"small",onClick:e=>m(o.properties.language),children:"New"})}),"\xa0\xa0\xa0"]}),!0!==j&&z&&(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(J.A,{title:"Click to change the language",children:(0,s.jsxs)(E.A,{size:"small",variant:"contained",color:"primary",className:"mr10",onClick:e=>{b()},children:[o.properties.language," ",(0,s.jsx)(Y.A,{})]})})}),M&&(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)(w.A,{sx:e=>({display:"inline",marginRight:"10px",border:"1px solid #ccc",padding:"3.9px 5px",paddingBottom:"8px",borderRadius:"4px",background:"code"===y?"linear-gradient(to right, ".concat("dark"===e.palette.mode?e.palette.grey[700]:e.palette.grey[300]," 50%, transparent 50%)"):"linear-gradient(to left, ".concat("dark"===e.palette.mode?e.palette.grey[700]:e.palette.grey[300]," 50%, transparent 50%)")}),children:[(0,s.jsx)(E.A,{size:"small",sx:e=>({color:e.palette.text.secondary,borderRadius:0}),onClick:()=>R("code"),children:"Code"}),(0,s.jsx)(E.A,{size:"small",sx:e=>({color:e.palette.text.secondary,borderRadius:0}),style:{borderLeft:"1px solid #ccc"},onClick:()=>R("console"),children:"I/O"})]})}),!0!==v&&(0,s.jsx)(J.A,{title:window.navigator.platform.match(/^Mac/)?"⌘ + return":"ctrl + enter",children:(0,s.jsxs)(E.A,{size:"small",variant:"contained",color:"secondary",className:"mr10",onClick:e=>A(),disabled:h,children:["Run ",(0,s.jsx)(eh.A,{})]})}),!0!==f&&(0,s.jsx)(X.Ay,{variant:"popover",popupId:"more-options-popup-menu",children:e=>(0,s.jsxs)(r.Fragment,{children:[(0,s.jsx)(C.A,{"aria-label":"more-options",...(0,ee.cO)(e),size:"large",children:(0,s.jsx)(Z.A,{})}),(0,s.jsxs)(q.A,{...(0,ee.NA)(e),children:[(0,s.jsx)(K.A,{onClick:()=>{e.close(),o.properties.files.map(e=>c.A.downloadEditorFile(e.name,e.content))},children:"Download"}),(0,s.jsx)(K.A,{onClick:()=>{e.close(),k()},children:"Editor Settings"}),!p&&(0,s.jsx)(K.A,{onClick:()=>{e.close(),O()},children:"Clear Output"}),!p&&(0,s.jsx)(K.A,{onClick:()=>{e.close(),S()},children:"Title & Visibility"}),!p&&(0,s.jsx)(K.A,{onClick:()=>{e.close(),window.open("/".concat(o.properties.language,"/wiki"),"_blank")},children:"How To (Wiki)"})]})]})}),T&&(0,s.jsx)(J.A,{title:"Full Screen",children:(0,s.jsx)(C.A,{onClick:()=>T(o),size:"large",children:I?(0,s.jsx)(G.A,{}):(0,s.jsx)(H.A,{})})})]})};var ef=i(18847),eC=i.n(ef),ew=i(96601),ek=i(25999),eO=i(76377);let eS=e=>{var t,i,l,n,a;let r=(0,$.A)(),{language:o,running:c,codeObj:p,hideStdin:h,handleInputUpdate:u}=e,g=(0,Q.A)(r.breakpoints.up("lg"));return(0,s.jsxs)(s.Fragment,{children:[p&&(null==(t=d[null==p||null==(i=p.properties)?void 0:i.language])?void 0:t.languageType)==="web"&&(0,s.jsx)(w.A,{id:"resultBrowser",sx:{height:e.isMobile?"calc(100vh - 105px)":"100%"},children:(0,s.jsx)(eO.A,{running:c,codeObj:p,language:o})}),p&&(null==(l=d[null==p||null==(n=p.properties)?void 0:n.language])?void 0:l.languageType)!=="web"&&(0,s.jsx)(w.A,{sx:{height:e.isMobile?"calc(100vh - 105px)":"100%"},children:(0,s.jsxs)(ew.YZ,{direction:"vertical",children:[!0!==h&&(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(ew.Zk,{defaultSize:g?11:20,children:(0,s.jsx)(w.A,{sx:{height:"100%",overflow:"auto",display:"flex",flexDirection:"column"},children:(0,s.jsx)(m.A,{sx:e=>({height:"100%","& .MuiInputBase-root":{height:"100%",alignItems:"flex-start"},"& .MuiInputBase-input":{height:"100%",boxSizing:"border-box",padding:e.spacing(1),overflow:"auto"},"& .MuiOutlinedInput-notchedOutline":{borderWidth:"0px",borderColor:"transparent !important"}}),onChange:e=>u(e.target.value),value:(null==p||null==(a=p.properties)?void 0:a.stdin)||"",label:"STDIN",placeholder:"Input for the program ( Optional )",margin:"normal",variant:"outlined",fullWidth:!0,multiline:!0,slotProps:{inputLabel:{shrink:!0}}})})})}),(0,s.jsx)(ew.TW,{style:{height:c||p.properties.result?"1px":"5px",background:"dark"===r.palette.mode?r.palette.alternate.dark:r.palette.grey[100]}}),(0,s.jsxs)(ew.Zk,{children:[c&&(0,s.jsx)(ek.A,{}),(0,s.jsxs)(w.A,{sx:e=>({paddingLeft:e.spacing(1),overflow:"auto",maxHeight:"100%",borderTop:!c&&p.properties.result?p.properties.result.success?"1.5px solid ".concat(e.palette.success.light," !important"):"1px solid ".concat(e.palette.error.light," !important"):void 0}),children:[(0,s.jsx)("p",{style:{fontSize:"0.875rem"},children:"Output:"}),(0,s.jsx)(w.A,{children:(0,s.jsx)("pre",{style:{fontSize:"0.875rem",lineHeight:"1.43"},children:p.properties.result&&p.properties.result.output||"Click on RUN button to see the output"})})]})]})]},g)})]})};var eI=i(20128);let eT=eC()(()=>Promise.all([i.e(2385),i.e(2866),i.e(3728),i.e(4252)]).then(i.bind(i,4252)),{loadableGenerated:{webpack:()=>[4252]},ssr:!1}),eR=e=>{let{language:t,running:i,hideStdin:l,codeObj:n,isOwnCode:a,hideResult:r,handleUpdate:o,codeVsConsoleSwitchValue:c,handleRunClick:p,height:h,codeTabIndex:u,disableCopyPaste:g,editorReadOnly:x,readOnlyList:m,handleInputUpdate:j}=e,b=(0,$.A)(),y=(0,Q.A)(b.breakpoints.down("sm")),v=(0,eI.M)().theme;return(0,s.jsxs)(ew.YZ,{autoSaveId:"oc:editor",direction:"horizontal",children:[!(y&&"console"===c)&&(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(ew.Zk,{defaultSize:60,children:n.properties.files.length>u&&(0,s.jsx)(eT,{onRun:()=>{p()},height:h||"100%",value:n.properties.files[u].content,mode:d[n.properties.language].fileVsMode?d[n.properties.language].fileVsMode[n.properties.files[u].name.split(".").pop()]:d[n.properties.language].mode,theme:(null==v?void 0:v.startsWith("dark"))?"dark":d[n.properties.language].theme,elevation:0,disableCopyPaste:g,readOnly:x||m&&m.length>0&&m.includes(n.properties.files[u].name),onChange:e=>{let t=[...n.properties.files];t[u].content=e,o(t,a)}})})}),!0!==r&&!(y&&"code"===c)&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(ew.TW,{style:{width:5,background:"dark"===b.palette.mode?b.palette.alternate.dark:b.palette.grey[100],"&:hover":{background:"dark"===b.palette.mode?b.palette.grey[700]:b.palette.grey[300],transition:"background 0.1s"}}}),(0,s.jsx)(ew.Zk,{defaultSize:40,children:(0,s.jsx)(eS,{isMobile:y,language:t,running:i,codeObj:n,hideStdin:l,handleInputUpdate:j})})]})]})};var eF=i(17159),ez=i(21271),eM=i(60155),eP=i(46137),eU=i(18726),e_=i(76462),eL=i(16401);let eW=e=>{var t,i;let{codeObj:l,token:n,isOwnCode:a,codeTabIndex:o,handleTabChange:p,handleUpdate:h,hideNewFileOption:g,readOnlyList:x,handleNewCodeId:j,handleAssestsOpen:b,handleAIImageOpen:y,embed:v}=e,[A,f]=r.useState(!1),[k,O]=r.useState(!1),[S,I]=r.useState(null),[T,R]=r.useState(""),[F,z]=r.useState(null),M=()=>{f(!1),I(null),R("")},P=()=>{O(!1),z(null)};return(0,s.jsxs)(w.A,{style:{display:"flex",flexDirection:"row"},children:[(0,s.jsx)(eP.H,{}),(0,s.jsx)(eF.A,{indicatorColor:"primary",textColor:"primary",variant:"scrollable",scrollButtons:"auto",value:o,onChange:(e,t)=>{p(t)},children:null==l||null==(i=l.properties)||null==(t=i.files)?void 0:t.map((e,t)=>(0,s.jsx)(eM.A,{label:e.name,handleEdit:d[l.properties.language].properties.filesEditable?()=>(e=>{I(e),R(l.properties.files[e].name),f(!0)})(t):null,handleDelete:!g&&d[l.properties.language].properties.newFileOptions&&d[l.properties.language].properties.newFileOptions.length&&!((null==x?void 0:x.length)>0&&x.includes(e.name))?()=>{z(e.name),O(!0)}:null},e.name))}),c.A.canHaveNewFiles(l)&&!g&&(0,s.jsx)(X.Ay,{variant:"popover",popupId:"new-file-menu",children:e=>(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(C.A,{"aria-label":"more-options-add-file",size:"large",...(0,ee.cO)(e),children:(0,s.jsx)(eU.A,{})}),(0,s.jsx)(q.A,{...(0,ee.NA)(e),children:d[l.properties.language].properties.newFileOptions.map(t=>(0,s.jsx)(K.A,{onClick:()=>{e.close();let i=[...l.properties.files],s=c.A.createNewFileAndContent(l.properties.files,t);s&&(i.push({...s}),h(i,a,!1,!0))},children:t.helpText},t.helpText))})]})}),c.A.canHaveImageUpload(l)&&!v&&(0,s.jsx)(J.A,{title:"Upload Images",arrow:!0,children:(0,s.jsx)(C.A,{size:"large","aria-label":"upload-image",onClick:()=>{if(!n)return void(0,eP.o)("Please login to upload images",{icon:"⚠️"});l._id||j(),b()},children:(0,s.jsx)(e_.A,{})})}),c.A.canHaveImageUpload(l)&&!v&&(0,s.jsx)(J.A,{title:"AI Image Generation",arrow:!0,children:(0,s.jsx)(C.A,{size:"large","aria-label":"ai-image-generation",sx:{display:{xs:"none",sm:"inline-flex"}},onClick:()=>{if(!n)return void(0,eP.o)("Please login to use AI image generation",{icon:"⚠️"});l._id||j(),y()},children:(0,s.jsx)(eL.A,{})})}),(0,s.jsxs)(u.A,{open:A,onClose:M,maxWidth:"sm",fullWidth:!0,children:[(0,s.jsx)(eu.A,{children:"Rename File"}),(0,s.jsx)(L.A,{children:(0,s.jsx)(m.A,{autoFocus:!0,margin:"dense",label:"File Name",type:"text",fullWidth:!0,variant:"outlined",value:T,onChange:e=>R(e.target.value)})}),(0,s.jsxs)(W.A,{children:[(0,s.jsx)(E.A,{onClick:M,children:"Cancel"}),(0,s.jsx)(E.A,{onClick:()=>{if(T&&null!==S){let e=[...l.properties.files];e[S].name=T,h(e,a,!0)}M()},variant:"contained",color:"primary",children:"Rename"})]})]}),(0,s.jsxs)(u.A,{open:k,onClose:P,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[(0,s.jsx)(eu.A,{id:"alert-dialog-title",children:"Delete File"}),(0,s.jsx)(L.A,{children:(0,s.jsxs)(ez.A,{id:"alert-dialog-description",children:['Are you sure you want to delete the file "',F,'"? This action cannot be undone.']})}),(0,s.jsxs)(W.A,{children:[(0,s.jsx)(E.A,{onClick:P,children:"Cancel"}),(0,s.jsx)(E.A,{onClick:()=>{if(F){let e=[...l.properties.files];h(e=e.filter(e=>e.name!==F),a)}P()},color:"error",autoFocus:!0,children:"Delete"})]})]})]})};var eE=i(22075);let eD=e=>{let{codeObj:t,isOwnCode:i,handleClick:l}=e;return(0,s.jsx)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-end"},children:(0,s.jsxs)(g.A,{variant:"body1",component:"h1",itemProp:"headline",color:"primary",style:i?{}:{paddingBottom:3,paddingTop:3,lineHeight:1.5},children:[null==t?void 0:t.title,"\xa0",i&&(0,s.jsx)(C.A,{"aria-label":"Edit",color:"primary",onClick:l,style:{padding:6},size:"large",children:(0,s.jsx)(eE.A,{fontSize:"small"})})]})})};var eN=i(42993),eV=i(60595),eB=i(23314),eH=i(95389),eG=i(69257),eY=i(32529),eZ=i(95654),eJ=i(37708),eq=i(45942);let eK=r.forwardRef(function(e,t){return(0,s.jsx)(h.A,{direction:"up",ref:t,...e})}),e$=function(e){let{open:t,codeId:i,userId:l,handleClose:n,userToken:o}=e,[d,c]=(0,r.useState)({}),[h,m]=(0,r.useState)([]),[j,b]=(0,r.useState)(!1),[y,v]=(0,r.useState)(!1),[A,f]=(0,r.useState)(null);(0,r.useEffect)(()=>{O()},[t]);let O=async()=>{if(!t)return;if(!o)return void b(!0);let{statusCode:e,json:i}=await (0,p.ZM)("/api/assets/".concat(l),o);200===e?(m(i),b(!0)):alert("Failed to fetch assets")},S=async e=>{if(!window.confirm("Are you sure you want to delete this image? This action cannot be undone."))return;f(e);let{statusCode:t,json:i,error:s}=await (0,p.wQ)("/api/assets/".concat(l,"/").concat(e),o);f(null),200===t?(b(!1),O()):alert("Failed to delete asset. Error: "+s)},I=function(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"url",s=t;"img"===i&&(s='<img src="'.concat(t,'" />')),navigator.clipboard.writeText(s),c({...d,["".concat(e,"_").concat(i)]:!0}),setTimeout(()=>{c({...d,["".concat(e,"_").concat(i)]:!1})},2e3)},T=async e=>{let t=e.target.files[0];if(!t)return;if(!t.type.startsWith("image/"))return void alert("Please select an image file");if(t.size>0xa00000)return void alert("File size must be less than 10MB");var s=new FormData;s.append("upload_file",t),v(!0);let{statusCode:n,json:a,error:r}=await (0,p.zo)("/api/assets/upload/".concat(l,"/").concat(i),o,s);v(!1),200===n?(null==a?void 0:a.status)==="success"&&(null==a?void 0:a.url)&&(b(!1),O()):alert("Failed to upload file. Error: "+r),e.target.value=null};return(0,s.jsxs)(u.A,{fullWidth:!0,maxWidth:"lg",open:t,onClose:n,TransitionComponent:eK,PaperProps:{sx:{borderRadius:2,backgroundImage:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",backgroundSize:"100% 4px",backgroundRepeat:"no-repeat",backgroundPosition:"top"}},children:[(0,s.jsx)(eu.A,{sx:{pb:2,pt:3},children:(0,s.jsxs)(eN.A,{direction:"row",alignItems:"center",justifyContent:"space-between",children:[(0,s.jsxs)(eN.A,{direction:"row",alignItems:"center",spacing:1.5,children:[(0,s.jsx)(w.A,{sx:{display:"flex",alignItems:"center",justifyContent:"center",width:40,height:40,borderRadius:"12px",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white"},children:(0,s.jsx)(eJ.A,{})}),(0,s.jsx)(w.A,{children:(0,s.jsx)(g.A,{variant:"h6",fontWeight:600,children:"Upload & Manage Images"})})]}),(0,s.jsxs)(w.A,{children:[(0,s.jsx)("input",{accept:"image/*",style:{display:"none"},id:"upload-image-button",type:"file",onChange:T,disabled:!l||!i||y}),(0,s.jsx)("label",{htmlFor:"upload-image-button",children:(0,s.jsx)(E.A,{variant:"contained",color:"primary",component:"span",disabled:!l||!i||y,startIcon:y?(0,s.jsx)(eg.A,{size:20,color:"inherit"}):(0,s.jsx)(eb.A,{}),sx:{borderRadius:2},children:y?"Uploading...":"Upload New"})})]})]})}),(0,s.jsxs)(L.A,{dividers:!0,sx:{pt:3,minHeight:400},children:[!j&&(0,s.jsx)(w.A,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:300,children:(0,s.jsx)(eg.A,{})}),j&&!o&&(0,s.jsx)(er.A,{severity:"info",sx:{borderRadius:2},children:"Please login to upload and manage images"}),j&&o&&0===h.length&&(0,s.jsxs)(w.A,{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:300,children:[(0,s.jsx)(eJ.A,{sx:{fontSize:80,color:"text.disabled",mb:2}}),(0,s.jsx)(g.A,{variant:"h6",color:"text.secondary",gutterBottom:!0,children:"No images uploaded yet"}),(0,s.jsx)(g.A,{variant:"body2",color:"text.secondary",children:'Click "Upload New" to add your first image'})]}),j&&h.length>0&&(0,s.jsx)(a.Ay,{container:!0,spacing:2,children:h.map(e=>(0,s.jsx)(a.Ay,{item:!0,xs:12,sm:6,md:4,children:(0,s.jsxs)(eV.A,{elevation:0,sx:{height:"100%",border:"1px solid",borderColor:"divider",borderRadius:2,transition:"all 0.2s ease","&:hover":{boxShadow:"0 4px 12px rgba(0,0,0,0.1)",transform:"translateY(-2px)"}},children:[(0,s.jsx)(eB.A,{component:"img",height:"200",image:e.url,alt:"Uploaded image",sx:{objectFit:"cover",backgroundColor:"#f5f5f5"}}),(0,s.jsx)(eH.A,{sx:{pb:1},children:(0,s.jsxs)(eN.A,{spacing:1,children:[(0,s.jsx)(w.A,{sx:{backgroundColor:e=>"dark"===e.palette.mode?"rgba(255, 255, 255, 0.08)":"rgba(0, 0, 0, 0.04)",border:"1px solid",borderColor:e=>"dark"===e.palette.mode?"rgba(255, 255, 255, 0.12)":"rgba(0, 0, 0, 0.12)",p:1,borderRadius:1,fontSize:"0.75rem",fontFamily:"monospace",wordBreak:"break-all",maxHeight:60,overflow:"auto",color:"text.primary"},children:e.url}),(0,s.jsx)(k.A,{label:function(e){if(0===e)return"0 Bytes";let t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(2))+" "+["Bytes","KB","MB","GB"][t]}(e.size),size:"small",variant:"outlined",sx:{alignSelf:"flex-start"}})]})}),(0,s.jsx)(x.A,{}),(0,s.jsxs)(eG.A,{sx:{justifyContent:"space-between",px:2},children:[(0,s.jsxs)(eN.A,{direction:"row",spacing:.5,children:[(0,s.jsx)(J.A,{title:d["".concat(e._id,"_url")]?"Copied!":"Copy URL",children:(0,s.jsx)(C.A,{size:"small",onClick:()=>I(e._id,e.url,"url"),sx:{color:d["".concat(e._id,"_url")]?"primary.main":"text.secondary"},children:(0,s.jsx)(eY.A,{fontSize:"small"})})}),(0,s.jsx)(J.A,{title:d["".concat(e._id,"_img")]?"Copied!":"Copy Image Tag",children:(0,s.jsx)(C.A,{size:"small",onClick:()=>I(e._id,e.url,"img"),sx:{color:d["".concat(e._id,"_img")]?"primary.main":"text.secondary"},children:(0,s.jsx)(eq.A,{fontSize:"small"})})})]}),(0,s.jsx)(J.A,{title:"Delete",children:(0,s.jsx)(C.A,{size:"small",color:"error",onClick:()=>S(e._id),disabled:A===e._id,children:A===e._id?(0,s.jsx)(eg.A,{size:18,color:"error"}):(0,s.jsx)(eZ.A,{fontSize:"small"})})})]})]})},e._id))})]}),(0,s.jsx)(W.A,{sx:{px:3,py:2},children:(0,s.jsxs)(w.A,{sx:{display:"flex",justifyContent:"space-between",width:"100%",alignItems:"center"},children:[(0,s.jsxs)(g.A,{variant:"caption",color:"text.secondary",children:[h.length," ",1===h.length?"image":"images"]}),(0,s.jsx)(E.A,{onClick:n,variant:"outlined",sx:{borderRadius:1},children:"Close"})]})})]})};var eQ=i(38505),eX=i(69579);let e0=r.forwardRef(function(e,t){return(0,s.jsx)(h.A,{direction:"up",ref:t,...e})}),e1=["A serene mountain landscape at sunset","A futuristic city with flying cars","A magical forest with glowing mushrooms","A cozy coffee shop on a rainy day","A space station orbiting Earth","A dragon flying over medieval castle"],e2=function(e){let{open:t,codeId:i,userId:l,handleClose:n,userToken:a}=e,[o,d]=(0,r.useState)(""),[c,h]=(0,r.useState)(null),[j,b]=(0,r.useState)(!1),[y,v]=(0,r.useState)(""),[A,f]=(0,r.useState)(""),[C,O]=(0,r.useState)("vivid"),[S,I]=(0,r.useState)("standard"),T=(0,r.useRef)(null);(0,r.useEffect)(()=>{c&&T.current&&setTimeout(()=>{T.current.scrollIntoView({behavior:"smooth",block:"nearest"})},100)},[c]);let R=async()=>{if(!o.trim())return void v("Please enter a prompt");if(!l||!i)return void v("Please save your code first to generate images");b(!0),v(""),h(null);try{let{statusCode:e,json:t,error:s}=await (0,p.RA)("/api/ai/image/".concat(l,"/").concat(i),a,{module:"editor",usecase:"generateImage",prompt:o.trim(),style:C,quality:S,size:"1024x1024"});200===e?(null==t?void 0:t.message)&&t.message.content&&t.message.content.includes("daily limit")?v("You have reached the daily limit for AI image generation. Please upgrade to a paid plan to continue."):(null==t?void 0:t.status)==="success"&&(null==t?void 0:t.url)?h(t.url):v((null==t?void 0:t.error)||s||"Failed to generate image"):v((null==t?void 0:t.error)||s||"Failed to generate image")}catch(e){v("Failed to generate image. Please try again.")}finally{b(!1)}},F=e=>{if(!c)return;let t="";switch(e){case"url":default:t=c;break;case"img":t='<img src="'.concat(c,'" />');break;case"markdown":t="![".concat(o,"](").concat(c,")")}navigator.clipboard.writeText(t),f(e),setTimeout(()=>f(""),2e3)},z=()=>{n(),setTimeout(()=>{h(null),d(""),v("")},300)};return(0,s.jsxs)(u.A,{fullWidth:!0,maxWidth:"md",open:t,onClose:z,TransitionComponent:e0,PaperProps:{sx:{borderRadius:2,backgroundImage:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",backgroundSize:"100% 4px",backgroundRepeat:"no-repeat",backgroundPosition:"top"}},children:[(0,s.jsx)(eu.A,{sx:{pb:2,pt:3},children:(0,s.jsxs)(eN.A,{direction:"row",alignItems:"center",spacing:1.5,children:[(0,s.jsx)(w.A,{sx:{display:"flex",alignItems:"center",justifyContent:"center",width:40,height:40,borderRadius:"12px",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white"},children:(0,s.jsx)(eX.A,{})}),(0,s.jsx)(w.A,{children:(0,s.jsx)(g.A,{variant:"h6",fontWeight:600,children:"AI Image Generation"})})]})}),(0,s.jsx)(L.A,{dividers:!0,sx:{pt:3},children:(0,s.jsxs)(eN.A,{spacing:3,children:[(0,s.jsx)(w.A,{children:(0,s.jsx)(m.A,{fullWidth:!0,multiline:!0,rows:3,value:o,onChange:e=>d(e.target.value),placeholder:"Be creative! Describe the image you want to generate...",disabled:j,error:!!y,helperText:y,sx:{"& .MuiOutlinedInput-root":{borderRadius:2,"&:hover fieldset":{borderColor:"#667eea"},"&.Mui-focused fieldset":{borderColor:"#764ba2"}}}})}),(0,s.jsx)(w.A,{children:(0,s.jsx)(w.A,{sx:{display:"flex",flexWrap:"wrap",gap:1},children:e1.map((e,t)=>(0,s.jsx)(k.A,{label:e,onClick:()=>{d(e)},variant:"outlined",size:"medium",clickable:!0,disabled:j,sx:{borderRadius:"16px",borderColor:"rgba(0, 0, 0, 0.12)",fontSize:"0.875rem",fontWeight:400,transition:"all 0.2s ease","&:hover":{borderColor:"#667eea",backgroundColor:"rgba(102, 126, 234, 0.08)",transform:"translateY(-1px)",boxShadow:"0 2px 8px rgba(102, 126, 234, 0.15)"},"&:active":{transform:"translateY(0)"},"& .MuiChip-label":{px:1.5}}},t))})}),(0,s.jsxs)(eN.A,{direction:"row",spacing:4,children:[(0,s.jsxs)(w.A,{children:[(0,s.jsx)(g.A,{variant:"subtitle2",fontWeight:500,gutterBottom:!0,children:"Style"}),(0,s.jsxs)(eN.A,{direction:"row",spacing:1,children:[(0,s.jsx)(k.A,{label:"Vivid",onClick:()=>O("vivid"),color:"vivid"===C?"primary":"default",variant:"vivid"===C?"filled":"outlined",disabled:j,sx:{borderRadius:"12px",minWidth:90,fontWeight:"vivid"===C?500:400,transition:"all 0.2s ease","&:hover":{transform:"vivid"!==C?"scale(1.05)":void 0}}}),(0,s.jsx)(k.A,{label:"Natural",onClick:()=>O("natural"),color:"natural"===C?"primary":"default",variant:"natural"===C?"filled":"outlined",disabled:j,sx:{borderRadius:"12px",minWidth:90,fontWeight:"natural"===C?500:400,transition:"all 0.2s ease","&:hover":{transform:"natural"!==C?"scale(1.05)":void 0}}})]})]}),(0,s.jsxs)(w.A,{children:[(0,s.jsx)(g.A,{variant:"subtitle2",fontWeight:500,gutterBottom:!0,children:"Quality"}),(0,s.jsxs)(eN.A,{direction:"row",spacing:1,children:[(0,s.jsx)(k.A,{label:"Standard",onClick:()=>I("standard"),color:"standard"===S?"primary":"default",variant:"standard"===S?"filled":"outlined",disabled:j,sx:{borderRadius:"12px",minWidth:90,fontWeight:"standard"===S?500:400,transition:"all 0.2s ease","&:hover":{transform:"standard"!==S?"scale(1.05)":void 0}}}),(0,s.jsx)(k.A,{label:"HD",onClick:()=>I("hd"),color:"hd"===S?"primary":"default",variant:"hd"===S?"filled":"outlined",disabled:j,sx:{borderRadius:"12px",minWidth:90,fontWeight:"hd"===S?500:400,transition:"all 0.2s ease","&:hover":{transform:"hd"!==S?"scale(1.05)":void 0}}})]})]})]}),(0,s.jsx)(E.A,{variant:"contained",color:"primary",size:"large",onClick:R,disabled:j||!o.trim()||!l||!i,startIcon:j?(0,s.jsx)(eg.A,{size:20,color:"inherit"}):(0,s.jsx)(eX.A,{}),fullWidth:!0,children:j?"Generating...":"Generate Image"}),c&&(0,s.jsx)(eQ.A,{in:!0,children:(0,s.jsxs)(eV.A,{ref:T,elevation:0,sx:{borderRadius:2,border:"1px solid",borderColor:"divider"},children:[(0,s.jsx)(eB.A,{component:"img",image:c,alt:"Generated",sx:{width:"100%",height:"auto",maxHeight:400,objectFit:"contain",backgroundColor:"#f5f5f5"}}),(0,s.jsx)(x.A,{}),(0,s.jsx)(w.A,{sx:{p:2},children:(0,s.jsxs)(eN.A,{direction:"row",spacing:1,justifyContent:"flex-end",children:[(0,s.jsx)(J.A,{title:"url"===A?"Copied!":"Copy URL",children:(0,s.jsx)(E.A,{size:"small",variant:"url"===A?"contained":"outlined",startIcon:(0,s.jsx)(eY.A,{fontSize:"small"}),onClick:()=>F("url"),sx:{borderRadius:1},children:"url"===A?"Copied!":"Copy URL"})}),(0,s.jsx)(J.A,{title:"img"===A?"Copied!":"Copy Image Tag",children:(0,s.jsx)(E.A,{size:"small",variant:"img"===A?"contained":"outlined",startIcon:(0,s.jsx)(eq.A,{fontSize:"small"}),onClick:()=>F("img"),sx:{borderRadius:1},children:"img"===A?"Copied!":"Copy Image Tag"})})]})})]})}),!l&&(0,s.jsx)(er.A,{severity:"info",sx:{borderRadius:2},children:"Please login to generate AI images"}),!i&&l&&(0,s.jsx)(er.A,{severity:"info",sx:{borderRadius:2},children:"Please save your code first (Ctrl+S) to generate images"})]})}),(0,s.jsx)(W.A,{sx:{px:3,py:2},children:(0,s.jsx)(E.A,{onClick:z,variant:"outlined",sx:{borderRadius:1},children:"Close"})})]})};class e5 extends r.Component{async componentDidMount(){this.setState({isServer:!1}),this.props.preFill&&!0===this.props.preFill.listenToEvents&&window.addEventListener("message",this.handleEmbedEvent);try{var e;if(this.props.preFill&&this.props.preFill.preloadCodeIds&&this.props.preFill.preloadCodeIds[this.state.codeObj.properties.language]&&!this.state.codeObj._id&&!(null==(e=this.props.preFill.codeObj)?void 0:e._id)){let e=[...this.state.codeObj.properties.files];e[0].content="Loading, Please wait...",this.setState({editorReadOnly:!0,codeObj:{...this.state.codeObj,properties:{...this.state.codeObj.properties,files:e}}});let t=this.props.preFill.preloadCodeIds[this.state.codeObj.properties.language],i=await (0,p.Jt)("/api/posts/".concat(t),this.props.userToken);i?(i._id=null,i.user=null,this.props.visibility&&(i.visibility=this.props.visibility),this.setState({codeObj:{...this.state.codeObj,...i},editorReadOnly:!1}),!0===this.props.preFill.listenToEvents&&i.properties&&i.properties.stdin&&window.postMessage({eventType:"populateStdinBack",stdin:i.properties.stdin||""},"*")):this.setState({editorReadOnly:!1})}}catch(e){console.log("Error while preload code ".concat(null==e?void 0:e.message))}}componentWillUnmount(){window.removeEventListener("message",this.handleEmbedEvent,!1)}handleEmbedEvent(e){if(e.data&&e.data.eventType)if("triggerRun"===e.data.eventType)this.handleOnRunClick();else if("populateCode"===e.data.eventType)if(e.data.language&&e.data.files&&e.data.files.length>0)if(d[e.data.language]){let t=JSON.parse(JSON.stringify(d[e.data.language]));t.visibility=this.props.visibility||this.state.codeObj.visibility||"public",t.properties.files=[...e.data.files],e.data.stdin&&(t.properties.stdin=e.data.stdin),e.data.result&&(t.properties.result=e.data.result),this.setState({codeObj:t})}else console.log("Invalid language "+e.data.language);else console.log("language & files are mandatory for populateCode event");else"populateStdin"===e.data.eventType&&this.setState({codeObj:{...this.state.codeObj,properties:{...this.state.codeObj.properties,stdin:e.data.stdin||""}}},()=>{this.props.handleCodeUpdate&&this.props.handleCodeUpdate(this.state.codeObj)})}isOwnCode(){return!!this.state.codeObj&&(!!this.state.codeObj.user&&!!this.props.loggedInUserObj&&!!this.props.loggedInUserObj._id&&this.state.codeObj.user._id===this.props.loggedInUserObj._id||!!this.state.codeObj.idToken)}render(){var e,t,i,r,o,d,c;let p=this.isOwnCode(),h=(0,s.jsx)(eW,{codeObj:this.state.codeObj,isOwnCode:p,codeTabIndex:this.state.codeTabIndex,handleTabChange:e=>this.setState({codeTabIndex:e}),handleUpdate:(e,t,i,s)=>this.handleUpdateCode(e,t,i,s),hideNewFileOption:this.props.preFill.hideNewFileOption,readOnlyList:this.props.preFill.readOnlyList,embed:this.props.embed,token:this.props.token,handleNewCodeId:this.createCodeId,handleAssestsOpen:()=>this.setState({imageUploadModelOpen:!0}),handleAIImageOpen:()=>this.setState({aiImageGenerationModelOpen:!0})}),u=(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(eA,{embed:this.props.embed,codeObj:this.state.codeObj,showAi:null==(e=this.props.preFill)?void 0:e.showAi,hideRun:null==(t=this.props.preFill)?void 0:t.hideRun,hideEditorOptions:null==(i=this.props.preFill)?void 0:i.hideEditorOptions,source:this.props.source,running:this.state.running,codeVsConsoleSwitchValue:this.state.codeVsConsoleSwitchValue||"code",hideNew:null==(r=this.props.preFill)?void 0:r.hideNew,hideLanguageSelection:null==(o=this.props.preFill)?void 0:o.hideLanguageSelection,handleNewClick:e=>this.updateLanguage(e),handleLanguageModelOpen:()=>this.setState({languageSelectionModelOpen:!0}),handleCodeVsConsoleSwitch:e=>this.setState({codeVsConsoleSwitchValue:e}),handleRunClick:this.handleOnRunClick,handleEditorSettingsOpen:()=>this.setState({editorSettingsModelOpen:!0}),handleClearOutput:()=>this.handleClearOutput(),handleCodeMetaEdit:()=>this.setState({editingModelOpen:!0}),fullscreen:this.props.fullscreen,switchFullscreen:this.props.switchFullscreen})});return(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)(l.A,{variant:"outlined",children:[this.state.isServer&&(0,s.jsx)(B,{codeObj:this.state.codeObj}),(0,s.jsxs)(n.A,{children:[(0,s.jsxs)(a.Ay,{container:!0,direction:"row",sx:{justifyContent:"space-between",alignItems:"center",display:{xs:"none",sm:"flex"},background:e=>"dark"===e.palette.mode?e.palette.alternate.dark:e.palette.grey[100]},children:[(0,s.jsx)(a.Ay,{item:!0,sx:{justifyContent:"space-between",alignItems:"center"},children:h}),(0,s.jsx)(a.Ay,{children:!(this.props.preFill&&!0===this.props.preFill.hideTitle)&&(0,s.jsx)(eD,{codeObj:this.state.codeObj,isOwnCode:p,handleClick:this.toggleEditingModel})}),(0,s.jsxs)(a.Ay,{item:!0,children:[" ",u," "]})]}),(0,s.jsxs)(a.Ay,{container:!0,direction:"column",sx:{display:{xs:"flex",sm:"none"},justifyContent:"space-between",alignItems:"center",background:e=>"dark"===e.palette.mode?e.palette.alternate.dark:e.palette.grey[100],paddingTop:e=>e.spacing(.5)},children:[(0,s.jsx)(a.Ay,{item:!0,xs:12,children:u}),"code"===this.state.codeVsConsoleSwitchValue&&(0,s.jsx)(a.Ay,{item:!0,xs:12,children:h})]}),(0,s.jsx)(eR,{language:this.props.language,running:this.state.running,hideStdin:(null==(d=this.props.preFill)?void 0:d.hideStdin)===!0,codeObj:this.state.codeObj,isOwnCode:p,codeVsConsoleSwitchValue:this.state.codeVsConsoleSwitchValue,handleRunClick:this.handleOnRunClick,height:this.props.height,codeTabIndex:this.state.codeTabIndex,disableCopyPaste:this.props.preFill.disableCopyPaste,editorReadOnly:this.state.editorReadOnly,readOnlyList:this.props.preFill.readOnlyList,handleUpdate:(e,t,i,s)=>this.handleUpdateCode(e,t,i,s),hideResult:null==(c=this.props.preFill)?void 0:c.hideResult,handleInputUpdate:e=>{this.setState({codeObj:{...this.state.codeObj,properties:{...this.state.codeObj.properties,stdin:e}}},()=>{this.props.handleCodeUpdate&&this.props.handleCodeUpdate(this.state.codeObj)})}})]}),(0,s.jsxs)("div",{children:[!this.props.fullscreen&&!this.props.embed&&this.state.codeObj&&this.state.codeObj.updated&&(0,s.jsx)(_,{codeObj:this.state.codeObj}),(0,s.jsx)(M,{source:this.props.source,isUserLoggedIn:!!this.props.token,countryCode:this.props.countryCode,availableLanguages:this.props.preFill?this.props.preFill.availableLanguages:null,handleListItemClick:e=>{this.setState({language:e,languageSelectionModelOpen:!1},()=>this.updateLanguage(e)),this.props.handleLanguageChange&&this.props.handleLanguageChange(e)},open:this.state.languageSelectionModelOpen,onClose:()=>{this.setState({languageSelectionModelOpen:!1})}}),(0,s.jsx)(e$,{codeId:this.state.codeObj._id,userId:this.props.loggedInUserObj._id,open:this.state.imageUploadModelOpen,handleClose:()=>this.setState({imageUploadModelOpen:!1}),userToken:this.props.token}),(0,s.jsx)(e2,{codeId:this.state.codeObj._id,userId:this.props.loggedInUserObj._id,open:this.state.aiImageGenerationModelOpen,handleClose:()=>this.setState({aiImageGenerationModelOpen:!1}),userToken:this.props.token})]}),(0,s.jsx)(A,{open:this.state.editorSettingsModelOpen,onClose:()=>this.setState({editorSettingsModelOpen:!1})}),(0,s.jsx)(V,{open:this.state.editingModelOpen,handleClose:()=>this.setState({editingModelOpen:!1}),codeObj:this.state.codeObj,handleUpdate:(e,t)=>this.handleUpdateCodeMeta(e,t),handleSave:()=>{this.setState({editingModelOpen:!1}),this.handleOnRunClick(!1)},visibility:this.props.visibility,token:this.props.token})]})})}constructor(e){var t,i;super(e),this.createCodeId=()=>{this.state.creatingCodeId||this.setState({creatingCodeId:!0,codeObj:{...this.state.codeObj,_id:null,title:"forking...",user:null}},()=>{fetch("/api/getIdAndToken").then(e=>e.json()).then(e=>{let t=e.id,i=e.token,s={...this.state.codeObj,_id:t,title:t};this.props.loggedInUserObj&&this.props.loggedInUserObj._id?s.user={_id:this.props.loggedInUserObj._id}:s.idToken=i,this.setState({creatingCodeId:!1,codeObj:s,output:null},()=>{this.props.handleCodeUpdate&&this.props.handleCodeUpdate(this.state.codeObj)})})})},this.handleClearOutput=async()=>{if(this.state.running)return;let e=await (0,p.RA)("/api/code/clearOutput",this.props.token,{...this.state.codeObj});(null==e?void 0:e.error)?alert(e.error):this.setState({output:null,codeObj:{...this.state.codeObj,properties:{...this.state.codeObj.properties,result:null}}},()=>{this.props.handleCodeUpdate&&this.props.handleCodeUpdate(this.state.codeObj)})},this.handleOnRunClick=async(e,t)=>{if(this.state.running)return;let i=this.isOwnCode();void 0===e&&(e=i),this.props.handleCodeUpdate&&this.props.handleCodeUpdate(this.state.codeObj,"runStart"),this.setState({output:"executing...",running:!0,success:null,codeVsConsoleSwitchValue:"console"});let s=c.A.clientValidation(this.state.codeObj),l=null;if("failed"===s.status)l={stdout:null,stderr:s.message};else{var n;this.props.handleRunStart&&this.props.handleRunStart(this.state.codeObj);let e=await (0,p.RA)("/api/code/exec",this.props.token||t,{...this.state.codeObj,visibility:this.props.visibility||this.state.codeObj.visibility||"public",parentURL:null==(n=this.props.preFill)?void 0:n.parentURL});l=e.error?{stdout:null,stderr:e.error}:e.json}let{success:a,output:r}=c.A.getResult(l);this.setState({success:a,output:r,running:!1,codeObj:{...this.state.codeObj,visibility:l.newVisibility||this.state.codeObj.visibility||"public",properties:{...this.state.codeObj.properties,result:{...this.state.codeObj.properties.result||{},success:a,output:r}}}},()=>{this.props.handleRunComplete&&this.props.handleRunComplete(this.state.codeObj,i)})},this.updateLanguage=async e=>{let t={...JSON.parse(JSON.stringify(d[e]))};if(this.props.preFill&&this.props.preFill.preloadCodeIds&&this.props.preFill.preloadCodeIds[e]){let i=this.props.preFill.preloadCodeIds[e],s=await fetch("/api/posts/".concat(i),{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(this.props.userToken)}});if(200===s.status){let e=await s.json();(t=e)._id=null,t.user=null,!0===this.props.preFill.listenToEvents&&e&&e.properties&&e.properties.stdin&&window.postMessage({eventType:"populateStdinBack",stdin:e.properties.stdin||""},"*")}else console.log("Missing permissions to preload code! id:"+i)}else!0===this.props.preFill.listenToEvents&&window.postMessage({eventType:"populateStdinBack",stdin:""},"*");this.setState({codeTabIndex:0,codeObj:{...t,visibility:this.props.visibility||this.state.codeObj.visibility||"public"}},()=>{this.props.handleNewCodeClick&&this.props.handleNewCodeClick(e)})},this.toggleEditingModel=()=>{this.setState({editingModelOpen:!this.state.editingModelOpen})},this.handleUpdateCode=(e,t,i,s)=>{i||c.A.updateFileNamesAndContent(e,this.state.codeObj.properties.language);let l=e.length<=this.state.codeTabIndex?this.state.codeTabIndex-1:this.state.codeTabIndex;-1===l&&(l=0),s&&(l=e.length-1),this.setState({codeObj:{...this.state.codeObj,properties:{...this.state.codeObj.properties,files:e}},codeTabIndex:l},()=>{t||this.createCodeId(),this.props.handleCodeUpdate&&this.props.handleCodeUpdate(this.state.codeObj,"codeUpdate")})},this.handleUpdateCodeMeta=(e,t)=>{this.setState({codeObj:{...this.state.codeObj,[e]:t}},()=>{this.props.handleCodeUpdate&&this.props.handleCodeUpdate(this.state.codeObj)})},this.handleTagsUpdate=e=>{if(e){let t=e.split(",").map(e=>e.trim().toLowerCase());this.setState({codeObj:{...this.state.codeObj,tags:t}})}else this.setState({codeObj:{...this.state.codeObj,tags:[]}})},this.handleCodeVsConsoleSwitch=(e,t)=>{this.setState({codeVsConsoleSwitchValue:t})},this.handleEmbedEvent=this.handleEmbedEvent.bind(this);let s=this.props.preFill||{},l=s.language||"java",n=s.codeObj||{...JSON.parse(JSON.stringify(d[l])),language:l,visibility:this.props.visibility||"public"};if((null==n||null==(t=n.properties)?void 0:t.result)&&(null==(i=d[l])?void 0:i.languageType)!=="web"){let{success:e,output:t}=c.A.getResult(n.properties.result);n.properties.result={...n.properties.result,success:e,output:t}}this.state={language:l,codeObj:n,languageSelectionModelOpen:!1,imageUploadModelOpen:!1,aiImageGenerationModelOpen:!1,output:null,running:!1,editingModelOpen:!1,creatingCodeId:!1,isServer:!0,codeTabIndex:0,editorSettingsModelOpen:!1,editorReadOnly:!1,codeVsConsoleSwitchValue:"code"}}}let e4=(0,o.Ng)(e=>({loggedInUserObj:e.user,token:e.user.token,countryCode:e.user.countryCode}),{})(e5)}}]);